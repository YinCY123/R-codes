---
title: "tidy-GSE107585-for-cc"
author: "yincy"
date: "4/15/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE}
library(data.table)
library(magrittr)
library(scater)
library(scran)
```


```{r}
# normalized 
sce.kidney <- readRDS("/home/yincy/git/Data/kidney-single-cell/GSE107585/sce.kidney_GSE107585.rds")
assayNames(sce.kidney)

sce.kidney.logcounts <- assay(sce.kidney, "logcounts")
sce.kidney.logcounts %>% dim()
sce.kidney.logcounts[1:10, 1:10]

fwrite(x = sce.kidney.logcounts, 
       file = "data/sce.kidney.logcounts.csv", 
       quote = F, 
       row.names = F, 
       sep = ",")
```

```{r}
meta_df <- colData(sce.kidney) %>% 
    as.data.frame() %>% 
    .[, c(1, 3)] %>% 
    dplyr::rename(Cell = cellid, cell_type = celltype)

write.csv(x = meta_df, file = "data/sce.kidney.meta.csv", row.names = F, quote = F)
```


